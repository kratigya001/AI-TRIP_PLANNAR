// import { GoogleGenerativeAI } from "@google/generative-ai";
// const apiKey = import .meta.env.VITE_GOOGLE_GEMINI_AI_API_KEY;
// //const model = 'gemini-2.5-pro';
// const genAI = new GoogleGenerativeAI(import.meta.env.VITE_GOOGLE_GEMINI_AI_API_KEY);
// export const model = genAI.getGenerativeModel({ model: "gemini-2.5-pro" });

// const api = 'streamGenerateContent';
// const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:${api}?key=${apiKey}`;

import { GoogleGenerativeAI } from "@google/generative-ai";

const apiKey =  import.meta.env.VITE_MAPBOX_API_KEY;

// Initialize the Google Generative AI with your API key
const genAI = new GoogleGenerativeAI(apiKey);

// Get the specific model and export it for use in other files
export const model = genAI.getGenerativeModel({ model: "gemini-2.5-flash-lite" });

function main() {
  const payload = {
    contents: [
      {
        role: 'user',
        parts: [
          {
            text: `Generate Travel Plan for Location: Las vegas, for 3 days for couple with a cheap budget, Give me a Hotels options List with HotelName, Hotel address, price, hotel image url, geo coordinates ,rating, descriptions and suggest itinerary with placeName, place Details, Place Image url , geo coordinates, ticket pricing , rating , time travel each of the location for 3 days with each day plan with best time to visit in JSON format\n`
          },
        ]
      },
      {
        role: 'model',
        parts: [
          {
            text: `**Finding Vegas Deals**\n\nI've initiated the search for affordable Las Vegas hotels, prioritizing options perfect for couples. My next step involves unearthing complimentary and inexpensive activities in the city, tailored for romantic outings. I aim to build a comprehensive list of budget-friendly experiences.\n\n\n**Pinpointing Romantic Itinerary**\n\nI'm now zeroing in on a 3-day itinerary, focusing on timing and cost-effective experiences for couples. I'm meticulously gathering location details, pricing, and ratings, while also calculating travel times. The goal is to maximize the budget without compromising the romance. All of this will be formatted in JSON as requested.\n\n\n**Drafting Vegas Itinerary**\n\nI've initiated the process of compiling a budget-friendly 3-day Las Vegas itinerary and cheap hotel options for a couple. Currently, I'm focusing on identifying and listing suitable hotel choices, ensuring they fit the budget and criteria specified. I'm aiming for concise descriptions and reliable data. Then I will start constructing the 3-day itinerary.\n\n\n**Defining Itinerary Parameters**\n\nI'm now incorporating detailed parameters for the Las Vegas trip. The user wants a comprehensive JSON output, so I'm structuring my approach accordingly. I've begun to break down the required elements: cheap hotel options with specific data points, and a meticulously planned 3-day itinerary with all specified details. My initial searches have provided a good springboard, but I now need to gather precise data for each category. I aim to refine hotel details and construct a feasible 3-day plan.\n\n\n**Structuring JSON Output**\n\nI'm now focusing on the meticulous structure of the JSON output. I'm actively refining my search queries to extract precise details for budget-friendly hotels, including addresses, geo-coordinates, and images. Simultaneously, I'm sourcing data for the itinerary locations, preparing to map them effectively within the 3-day plan. Travel time estimations and operational hour confirmations are underway to ensure a seamless and efficient user experience.\n\n\n**Detailing Budget Hotels**\n\nMy focus is now on meticulously collecting the precise data points for budget hotels. I'm actively researching Ellis Island Hotel, The STRAT Hotel, Excalibur Hotel, and Circus Circus Hotel to gather specific details: addresses, prices, image URLs, geo-coordinates, and ratings. I'm leveraging search tools to extract this structured information, ensuring accuracy for the final JSON output.\n\n\n**Locating Budget Stays**\n\nI've assembled a list of potential hotels, focusing on affordability. This includes addresses, fluctuating price ranges, brief descriptions, and ratings. I've also pinpointed the geo-coordinates for The STRAT Hotel, which is useful for spatial analysis.\n\n\n**Finding Hotel Coordinates**\n\nI'm now focused on completing the hotel data. My efforts have been concentrated on locating geo-coordinates and image URLs for the remaining budget-friendly hotels. I'm also preparing to structure a 3-day itinerary from my initial list of cheap activities. I need to gather addresses, geo-coordinates, image URLs, prices, ratings, and travel times for each itinerary item. I'm excited to make headway on both fronts.\n\n\n**Considering Hotel Options**\n\nI've assembled key details for several hotel options, focusing on budget-friendly picks like Ellis Island and Excalibur, with names, addresses, and geo-coordinates in hand. Now, I am digging deeper into customer reviews to assess overall value and specific needs.\n\n\n**Organizing Itinerary Details**\n\nI've assembled a comprehensive list of hotels, including names, addresses, and coordinates for budget options like Ellis Island, Excalibur, Circus Circus, Luxor, and Flamingo. I'm now seeking representative image URLs for these hotels to complete the details. Concurrently, I've gathered data on free and low-cost attractions and paid attractions, noting their addresses, coordinates, and pricing. To finalize the itinerary, I'll incorporate image URLs for each location, assign ratings, and estimate travel times, structuring this into a coherent 3-day plan.\n\n\n**Consolidating Image Search**\n\nI've assembled hotels and itinerary details, including names, addresses, and geo-coordinates for budget-friendly options. I'm focusing on securing representative image URLs for hotels like Ellis Island and Excalibur, along with attractions for a concise, budget-conscious 3-day plan. I'm now structuring the JSON format, integrating image URLs and travel-time estimates to deliver a well-organized travel guide. I'm building a cohesive 3-day itinerary, incorporating free activities and one paid attraction each day, finalizing the couple's Vegas adventure.\n\n\n**Formulating the Final JSON**\n\nI've gathered hotels and itinerary details, including names, addresses, and geo-coordinates for budget options like Ellis Island, Excalibur, Circus Circus, Luxor, and Flamingo. I have begun structuring the JSON format and I'm integrating image URLs and travel-time estimates to deliver a comprehensive, well-organized travel guide. I'm focusing on ensuring all required fields are populated for the final JSON output.\n\n\n`
          },
          {
            text: "`` `json\n{\n  \"travelPlan\": {\n    \"location\": \"Las Vegas\",\n    \"duration\": \"3 days\",\n    \"travelerType\": \"couple\",\n    \"budget\": \"cheap\",\n    \"hotelOptions\": [\n      {\n        \"HotelName\": \"Ellis Island Hotel Casino & Brewery\",\n        \"Hotel address\": \"4250 Koval Ln, Las Vegas, NV 89109\",\n        \"price\": \"Approximately $50-$150 per night\",\n        \"hotel_image_url\": \"https://images.trvl-media.com/lodging/1000000/20000/18200/18104/f5c3f3f7.jpg?impolicy=resizecrop&rw=1200&ra=fit\",\n        \"geo_coordinates\": {\n          \"latitude\": 36.1146,\n          \"longitude\": -115.1658\n        },\n        \"rating\": \"4.0/5\",\n        \"descriptions\": \"A budget-friendly hotel with its own brewery and casino, located a short walk from the Strip. Known for its good value and lively atmosphere.\"\n      },\n      {\n        \"HotelName\": \"The STRAT Hotel, Casino & SkyPod\",\n        \"Hotel address\": \"2000 Las Vegas Blvd S, Las Vegas, NV 89104\",\n        \"price\": \"Approximately $40-$120 per night\",\n        \"hotel_image_url\": \"https://images.trvl-media.com/lodging/1000000/10000/2300/2287/a2d0c2d5.jpg?impolicy=resizecrop&rw=1200&ra=fit\",\n        \"geo_coordinates\": {\n          \"latitude\": 36.1476,\n          \"longitude\": -115.1568\n        },\n        \"rating\": \"3.5/5\",\n        \"descriptions\": \"Famous for its iconic tower with thrilling rides and an observation deck offering panoramic views of the city. The hotel offers affordable rooms.\"\n      },\n      {\n        \"HotelName\": \"Excalibur Hotel & Casino\",\n        \"Hotel address\": \"3850 S Las Vegas Blvd, Las Vegas, NV 89109\",\n        \"price\": \"Approximately $30-$100 per night\",\n        \"hotel_image_url\": \"https://images.trvl-media.com/lodging/1000000/10000/1100/1055/a14591f1.jpg?impolicy=resizecrop&rw=1200&ra=fit\",\n        \"geo_coordinates\": {\n          \"latitude\": 36.0986,\n          \"longitude\": -115.1758\n        },\n        \"rating\": \"3.5/5\",\n        \"descriptions\": \"A castle-themed hotel that offers a fun and unique experience at a budget-friendly price. It's well-located on the south end of the Strip.\"\n      },\n      {\n        \"HotelName\": \"Circus Circus Hotel & Casino\",\n        \"Hotel address\": \"2880 S Las Vegas Blvd, Las Vegas, NV 89109\",\n        \"price\": \"Approximately $25-$90 per night\",\n        \"hotel_image_url\": \"https://images.trvl-media.com/lodging/1000000/10000/2400/2375/3b754674.jpg?impolicy=resizecrop&rw=1200&ra=fit\",\n        \"geo_coordinates\": {\n          \"latitude\": 36.1373,\n          \"longitude\": -115.1649\n        },\n        \"rating\": \"3.0/5\",\n        \"descriptions\": \"A very budget-friendly option with a circus theme, featuring the Adventuredome indoor theme park and free circus acts daily.\"\n      },\n      {\n        \"HotelName\": \"Luxor Hotel & Casino\",\n        \"Hotel address\": \"3900 S Las Vegas Blvd, Las Vegas, NV 89119\",\n        \"price\": \"Approximately $40 - $130 per night\",\n        \"hotel_image_url\": \"https://images.trvl-media.com/lodging/1000000/10000/1100/1053/e7e9a2b7.jpg?impolicy=resizecrop&rw=1200&ra=fit\",\n        \"geo_coordinates\": {\n          \"latitude\": 36.0955,\n          \"longitude\": -115.1761\n        },\n        \"rating\": \"3.5/5\",\n        \"descriptions\": \"An iconic pyramid-shaped hotel with an Egyptian theme. Offers a unique experience with a large casino and multiple entertainment options at a reasonable price. [18]\"\n      },\n      {\n        \"HotelName\": \"Flamingo Las Vegas Hotel & Casino\",\n        \"Hotel address\": \"3555 S Las Vegas Blvd, Las Vegas, NV 89109\",\n        \"price\": \"Approximately $50 - $170 per night\",\n        \"hotel_image_url\": \"https://images.trvl-media.com/lodging/1000000/10000/2400/2324/5a5c6020.jpg?impolicy=resizecrop&rw=1200&ra=fit\",\n        \"geo_coordinates\": {\n          \"latitude\": 36.1161,\n          \"longitude\": -115.1706\n        },\n        \"rating\": \"3.5/5\",\n        \"descriptions\": \"A classic Vegas hotel with a vibrant, tropical theme and a fantastic mid-strip location. Features a wildlife habitat with flamingos. [10]\"\n      }\n    ],\n    \"itinerary\": [\n      {\n        \"day\": 1,\n        \"theme\": \"South Strip Exploration & Iconic Sights\",\n        \"best_time_to_visit\": \"Afternoon to Evening\",\n        \"plan\": [\n          {\n            \"placeName\": \"Welcome to Fabulous Las Vegas Sign\",\n            \"place Details\": \"Start your trip with a classic photo opportunity at the iconic 'Welcome to Fabulous Las Vegas' sign. It's a must-do for first-time visitors.\",\n            \"Place_Image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Welcome_to_Fabulous_Las_Vegas_sign.jpg/1200px-Welcome_to_Fabulous_Las_Vegas_sign.jpg\",\n            \"geo_coordinates\": {\n              \"latitude\": 36.0821,\n              \"longitude\": -115.1728\n            },\n            \"ticket_pricing\": \"Free\",\n            \"rating\": \"4.5/5\",\n            \"time_travel_from_previous\": \"N/A\"\n          },\n          {\n            \"placeName\": \"Explore Luxor and Excalibur\",\n            \"place Details\": \"Walk through the pyramid-themed Luxor and the castle-themed Excalibur hotels. These unique architectures are sights in themselves and free to explore.\",\n            \"Place_Image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c5/Luxor_Hotel_and_Casino_as_seen_from_the_Excalibur_Hotel_and_Casino.jpg/1200px-Luxor_Hotel_and_Casino_as_seen_from_the_Excalibur_Hotel_and_Casino.jpg\",\n            \"geo_coordinates\": {\n              \"latitude\": 36.0955,\n              \"longitude\": -115.1761\n            },\n            \"ticket_pricing\": \"Free\",\n            \"rating\": \"4.0/5\",\n            \"time_travel_from_previous\": \"15-20 minute walk\"\n          },\n          {\n            \"placeName\": \"Bellagio Conservatory & Botanical Gardens\",\n            \"place Details\": \"Be amazed by the stunning floral displays inside the Bellagio. The theme of the conservatory changes seasonally, so there's always something new to see. It is open 24 hours a day and is free to visit. [17]\",\n            \"Place_Image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/f/f6/Bellagio_Conservatory_%26_Botanical_Gardens_-_Spring_2019.jpg/1200px-Bellagio_Conservatory_%26_Botanical_Gardens_-_Spring_2019.jpg\",\n            \"geo_coordinates\": {\n              \"latitude\": 36.1130,\n              \"longitude\": -115.1757\n            },\n            \"ticket_pricing\": \"Free. [19]\",\n            \"rating\": \"4.8/5\",\n            \"time_travel_from_previous\": \"20-25 minute walk or a short bus/tram ride\"\n          },\n          {\n            \"placeName\": \"Fountains of Bellagio\",\n            \"place Details\": \"Witness the famous and romantic fountain show outside the Bellagio. The shows run every 30 minutes in the afternoon and every 15 minutes in the evening. Each show is a different choreographed performance. [17]\",\n            \"Place_Image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Fountains_of_Bellagio_at_dusk.jpg/1200px-Fountains_of_Bellagio_at_dusk.jpg\",\n            \"geo_coordinates\": {\n              \"latitude\": 36.1127,\n              \"longitude\": -115.1742\n            },\n            \"ticket_pricing\": \"Free\",\n            \"rating\": \"4.8/5\",\n            \"time_travel_from_previous\": \"2 minute walk\"\n          }\n        ]\n      },\n      {\n        \"day\": 2,\n        \"theme\": \"Mid-Strip Adventures & High-Up Views\",\n        \"best_time_to_visit\": \"Afternoon to Late Night\",\n        \"plan\": [\n          {\n            \"placeName\": \"The LINQ Promenade\",\n            \"place Details\": \"Stroll through this open-air shopping, dining, and entertainment district. It has a vibrant atmosphere with many things to see and do.\",\n            \"Place_Image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/The_LINQ_Promenade.jpg/1200px-The_LINQ_Promenade.jpg\",\n            \"geo_coordinates\": {\n              \"latitude\": 36.1179,\n              \"longitude\": -115.1710\n            },\n            \"ticket_pricing\": \"Free to walk through\",\n            \"rating\": \"4.5/5\",\n            \"time_travel_from_previous\": \"N/A (can be reached by walking or bus from most hotels)\"\n          },\n          {\n            \"placeName\": \"High Roller Observation Wheel\",\n            \"place Details\": \"For a stunning view of the Las Vegas Strip, take a ride on the High Roller, the world's tallest observation wheel. To save money, consider going during the daytime. The ride takes about 30 minutes to complete one revolution. [42]\",\n            \"Place_Image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/f/f7/High_Roller_%28Ferris_wheel%29.jpg/800px-High_Roller_%28Ferris_wheel%29.jpg\",\n            \"geo_coordinates\": {\n              \"latitude\": 36.1174,\n              \"longitude\": -115.1681\n            },\n            \"ticket_pricing\": \"Daytime tickets are cheaper, approximately $25-$35. [42]\",\n            \"rating\": \"4.7/5\",\n            \"time_travel_from_previous\": \"Located within The LINQ Promenade\"\n          },\n          {\n            \"placeName\": \"Explore The Venetian and Caesars Palace\",\n            \"place Details\": \"Experience a taste of Italy at The Venetian with its indoor canals and gondola rides (which you can watch for free). Then, walk through The Forum Shops at Caesars Palace to admire the Roman-themed architecture and the Fall of Atlantis animatronic show.\",\n            \"Place_Image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/5/58/The_Venetian_Las_Vegas.jpg/1200px-The_Venetian_Las_Vegas.jpg\",\n            \"geo_coordinates\": {\n              \"latitude\": 36.1213,\n              \"longitude\": -115.1696\n            },\n            \"ticket_pricing\": \"Free to explore, Gondola rides have a fee\",\n            \"rating\": \"4.7/5\",\n            \"time_travel_from_previous\": \"10-15 minute walk\"\n          }\n        ]\n      },\n      {\n        \"day\": 3,\n        \"theme\": \"Downtown Vegas & North Strip Views\",\n        \"best_time_to_visit\": \"Evening to Late Night\",\n        \"plan\": [\n          {\n            \"placeName\": \"Fremont Street Experience\",\n            \"place Details\": \"Head to Downtown Las Vegas to experience the Fremont Street Experience. This pedestrian mall features a massive LED canopy with free light shows, live music on multiple stages, and a vibrant, old-school Vegas atmosphere. [20]\",\n            \"Place_Image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b3/Fremont_Street_Experience%2C_Las_Vegas%2C_2016.jpg/1200px-Fremont_Street_Experience%2C_Las_Vegas%2C_2016.jpg\",\n            \"geo_coordinates\": {\n              \"latitude\": 36.1706,\n              \"longitude\": -115.1451\n            },\n            \"ticket_pricing\": \"Free. [20]\",\n            \"rating\": \"4.6/5\",\n            \"time_travel_from_previous\": \"A bus ride or a short drive from the Strip\"\n          },\n          {\n            \"placeName\": \"The STRAT SkyPod Observation Deck\",\n            \"place Details\": \"End your trip with breathtaking 360-degree views of Las Vegas from the top of The STRAT. It's a great way to see the entire valley and the Strip light up at night. For thrill-seekers, there are also exciting rides at the top (for an additional cost).\",\n            \"Place_Image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/1/1a/Stratosphere_Tower_-_Las_Vegas.jpg/800px-Stratosphere_Tower_-_Las_Vegas.jpg\",\n            \"geo_coordinates\": {\n              \"latitude\": 36.1476,\n              \"longitude\": -115.1568\n            },\n            \"ticket_pricing\": \"Approximately $20-$30 for the observation deck\",\n            \"rating\": \"4.5/5\",\n            \"time_travel_from_previous\": \"A short bus ride or drive from Fremont Street\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```"
          },
        ]
      },
 
    ],
    generationConfig: {
      thinkingConfig: {
        thinkingBudget: -1,
      },
    },
    tools: [
      {
        googleSearch: {}
      },
    ],
  };

  const options = {
    method: 'POST',
    contentType: 'application/json',
    muteHttpExceptions: true,
    payload: JSON.stringify(payload),
  };

  const response = UrlFetchApp.fetch(url, options);
  const chunks = JSON.parse(response.getContentText());


}
